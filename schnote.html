<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Students Support System</title>
  <link href="https://cdn.quilljs.com/1.3.7/quill.snow.css" rel="stylesheet">
  <link rel="manifest" href="/manifest.json">
  <style>
    body {
      font-family: 'Arial', sans-serif;
      margin: 0;
      padding: 0;
      background: linear-gradient(to right, blue, orange);
      color: black;
    }
    header {
      background: white;
      color: white;
      padding: 10px;
      text-align: center;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      font-size: 0.7rem;
      font-weight: bold;
    }
    header h1, header h2 {
      margin: 5px;
    }
    .content {
      text-align: center;
      font-family: Arial, sans-serif;
    }
    .logo {
      width: 140px;
      height: auto;
      margin-top: 1rem;
      top: 0px;
      position: center;
    }
    .container {
      max-width: 1200px;
      margin: 20px auto;
      padding: 10px;
      background: white;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }
    h3 {
      color: #0055cc;
      border-bottom: 2px solid #0055cc;
      padding-bottom: 5px;
    }
    .table-wrapper {
      overflow-x: auto;
      border: 1px solid #ddd;
      border-radius: 8px;
      margin-bottom: 20px;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      table-layout: fixed;
    }
    th, td {
      border: 0.5px solid #ddd;
      padding: 6px;
      text-align: left;
      vertical-align: left;
      font-size: 0.50rem;
      font-weight: bold;
    }
    th {
      background-color: #0055cc;
      color: white;
    }
    select, input[type="text"], button {
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 5px;
      font-size: 0.9rem;
      margin: 5px 0;
    }
    button {
      background-color: #0055cc;
      color: white;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background-color: #003b8a;
    }
    #noteEditor {
      border: 1px solid #ddd;
      margin-bottom: 10px;
      height: 200px;
    }
    ul {
      padding: 0;
      list-style: none;
    }
    ul li {
      margin: 10px 0;
      padding: 10px;
      background: orange;
      border: 1px solid #ddd;
      border-radius: 10px;
      color: black;
    }
    #categories {
      display: flex;
      gap: 5px;
      flex-wrap: wrap;
      margin-bottom: 10px;
    }
    .popup {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      flex-direction: column;
    }
    .welcomePopup-content, .popup-content {
      background: white;
      color: #333;
      padding: 20px;
      border-radius: 10px;
      max-width: 600px;
      width: 90%;
      overflow-y: auto;
    }
    .popup-footer {
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 5px;
      padding: 8px;
      border-top: 1px solid #ccc;
      background-color: #f9f9f9;
    }
    .popup-footer button, .popup-footer label, .popup-footer input {
      margin: 2px;
      padding: 5px 10px;
      font-size: 0.8rem;
    }
    .prompt-overlay, .hidden {
      display: none !important;
    }
    #calendar {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 2px;
      background: #f5f5f5;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 9px;
      margin-top: 8px;
      overflow-x: auto;
    }
    .day {
      background: #e7eaf3;
      border: 1px solid #ddd;
      padding: 6px;
      font-size: 0.6rem;
      text-align: center;
      border-radius: 5px;
      font-weight: bold;
    }
    .day.today {
      background: #0055cc;
      color: white;
      font-weight: bold;
    }
    #browserIcon {
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 1001;
      background: #4caf50;
      color: white;
      border: none;
      padding: 10px;
      border-radius: 50%;
      font-size: 20px;
      cursor: pointer;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    #browserIcon:hover {
      background: #45a049;
    }
    #miniBrowser {
      display: none;
      position: fixed;
      top: 5%;
      left: 5%;
      width: 90%;
      height: 90%;
      background: white;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      z-index: 1000;
      overflow: hidden;
      border: 1px solid #ccc;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
    }
    .top-controls {
      display: flex;
      gap: 5px;
      padding: 10px;
      background: #ddd;
      border-bottom: 1px solid #ccc;
    }
    .top-controls input {
      flex: 1;
      padding: 5px;
      border: 1px solid #aaa;
      border-radius: 5px;
    }
    .top-controls button {
      padding: 5px 10px;
      background: #4caf50;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    .top-controls button:hover {
      background: #45a049;
    }
    #browserFrame {
      flex: 1;
      width: 100%;
      border: none;
    }
    .bottom-controls {
      display: flex;
      gap: 5px;
      padding: 10px;
      background: #ddd;
      border-top: 1px solid #ccc;
      justify-content: center;
    }
    .bottom-controls button {
      padding: 5px 10px;
      background: #4caf50;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    .bottom-controls button:hover {
      background: #45a049;
    }
  </style>
</head>
<body>
  <header>
    <h1>Obafemi Awolowo University</h1>
    <h2>Students Support System</h2>
  </header>

  <div id="customPrompt" class="prompt-overlay">
    <div class="prompt-box">
      <h3 id="promptTitle">Enter Note Title</h3>
      <input type="text" id="promptInput" placeholder="Type here..." />
      <div class="prompt-actions">
        <button id="promptOk">OK</button>
        <button id="promptCancel">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Browser Icon -->
  <button id="browserIcon" onclick="toggleMiniBrowser()">üåê Open</button>

  <!-- Mini Browser -->
  <div id="miniBrowser" class="hidden">
    <!-- Top Controls -->
    <div class="browser-controls top-controls">
      <input type="text" id="browserUrl" placeholder="Enter URL (e.g., https://www.google.com)" />
      <button onclick="navigateBrowser()">Go</button>
    </div>

    <!-- Browser Content -->
    <iframe id="browserFrame" src="https://www.wikipedia.org"></iframe>

    <!-- Footer Controls -->
    <div class="browser-controls bottom-controls">
      <button onclick="goBack()">Back</button>
      <button onclick="goForward()">Forward</button>
      <button onclick="reloadBrowser()">Reload</button>
      <button onclick="goHome()">Home</button>
    </div>
  </div>

  <div class="container">
    <!-- Class Scheduler -->
    <div id="scheduleSection">
      <h3>Class Scheduler</h3>
      <div>
        <p>Enter the schedule code to load predefined classes:</p>
        <input type="text" id="scheduleCode" placeholder="Enter code">
        <button onclick="loadDepartmentSchedule()">Load Schedule</button>
        <button onclick="savePredefinedToLocalStorage()">Save Predefined Schedule</button>
      </div>
      <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              <th>Time</th>
              <th>Mon</th>
              <th>Tues</th>
              <th>Wed</th>
              <th>Thur</th>
              <th>Fri</th>
            </tr>
          </thead>
          <tbody id="scheduleBody"></tbody>
        </table>
      </div>
    </div>

    <h4>Add Schedule</h4>
    <select id="timeInput">
      <option value="">Select Time</option>
      <option value="1:00 AM">1:00 AM</option>
      <option value="2:00 AM">2:00 AM</option>
      <option value="3:00 AM">3:00 AM</option>
      <option value="4:00 AM">4:00 AM</option>
      <option value="5:00 AM">5:00 AM</option>
      <option value="6:00 AM">6:00 AM</option>
      <option value="7:00 AM">7:00 AM</option>
      <option value="8:00 AM">8:00 AM</option>
      <option value="9:00 AM">9:00 AM</option>
      <option value="10:00 AM">10:00 AM</option>
      <option value="11:00 AM">11:00 AM</option>
      <option value="12:00 PM">12:00 PM</option>
      <option value="1:00 PM">1:00 PM</option>
      <option value="2:00 PM">2:00 PM</option>
      <option value="3:00 PM">3:00 PM</option>
      <option value="4:00 PM">4:00 PM</option>
      <option value="5:00 PM">5:00 PM</option>
      <option value="6:00 PM">6:00 PM</option>
      <option value="7:00 PM">7:00 PM</option>
      <option value="8:00 PM">8:00 PM</option>
      <option value="9:00 PM">9:00 PM</option>
      <option value="10:00 PM">10:00 PM</option>
      <option value="11:00 PM">11:00 PM</option>
      <option value="12:00 AM">12:00 AM</option>
    </select>
    <select id="dayInput">
      <option value="">Select Day</option>
      <option value="Monday">Monday</option>
      <option value="Tuesday">Tuesday</option>
      <option value="Wednesday">Wednesday</option>
      <option value="Thursday">Thursday</option>
      <option value="Friday">Friday</option>
    </select>
    <input type="text" id="subjectInput" placeholder="Subject">
    <button onclick="addSchedule()">Add</button>

    <!-- Notes Section -->
    <div id="notesSection">
      <h3>Notes</h3>
      <div id="categories">
        <button onclick="showCategory('Personal')">Personal</button>
        <button onclick="showCategory('Academic')">Academic</button>
        <button onclick="showCategory('Miscellaneous')">Miscellaneous</button>
        <button onclick="addCategory()">Add Category</button>
      </div>
      <div id="noteEditor" style="height: 300px;"></div> 
      <input type="file" id="noteMedia" accept="image/*">
      <button onclick="saveNote()">Save Note</button>
    </div>
    <ul id="notesList"></ul>

    <!-- Note Popup -->
    <div id="notePopup" class="popup">
      <div class="popup-content" id="popupContent">
        <h3 id="noteTitle"></h3>
        <div id="noteContent" contenteditable="false" style="position: relative;"></div>
        <canvas id="drawingCanvas" style="white-space: pre-wrap; position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: none;"></canvas>
        <img id="noteMediaPreview" alt="" style="max-width: 100%; display: none;">
      </div>
      <div class="popup-footer">
        <div style="flex-grow: 1; display: flex; align-items: center;">
          <label for="highlightColor">Highlight:</label>
          <input type="color" id="highlightColor" value="#FFFF00" style="margin-left: 5px;">
        </div>
        <button onclick="enableTextHighlighting()">Enable Text Highlighting</button>
        <button onclick="enableDrawing()">Enable Freehand Drawing</button>
        <button onclick="disableDrawing()">Disable Freehand Drawing</button>
        <button onclick="saveHighlightedText()">Save Highlights</button>
        <button id="previousNoteButton" onclick="navigateNote(-1)">Previous</button>
        <button id="nextNoteButton" onclick="navigateNote(1)">Next</button>
        <button id="editNoteButton" onclick="editNote()">Edit</button>
        <button id="deleteNoteButton" onclick="deleteNote()">Delete</button>
        <button onclick="closeNotePopup()">Close</button>
      </div>
    </div>

    <!-- Calendar -->
    <div id="calendarSection">
      <h3>Weekly Calendar</h3>
      <div id="calendar"></div>
      <p id="calendarMessage" style="margin-top: 10px; color: #0055cc; font-weight: bold;"></p>
    </div>
  </div>

  <link href="https://cdn.quilljs.com/1.3.7/quill.snow.css" rel="stylesheet">
  <script src="https://cdn.quilljs.com/1.3.7/quill.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathquill/0.10.1/mathquill.min.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/mathquill/0.10.1/mathquill.min.css" rel="stylesheet">
  <script>
// Initialize the rich text editor for notes
const quill = new Quill('#noteEditor', {
  theme: 'snow',
  placeholder: 'Start typing...',
  modules: {
    toolbar: [
      ['bold', 'italic', 'underline', 'strike'], // Basic formatting
      [{ 'font': [] }], // Font family
      [{ 'size': ['small', false, 'large', 'huge'] }], // Font size
      [{ 'header': [1, 2, 3, 4, 5, 6, false] }], // Header levels
      [{ 'align': [] }], // Alignment
      [{ 'color': [] }, { 'background': [] }], // Text and background colors
      [{ 'list': 'ordered' }, { 'list': 'bullet' }], // Lists
      [{ 'indent': '-1' }, { 'indent': '+1' }], // Indentation
      [{ 'script': 'sub' }, { 'script': 'super' }], // Subscript and superscript
      [{ 'direction': 'rtl' }], // Text direction
      ['link', 'image', 'video'], // Links, images, and videos
      ['code-block', 'blockquote'], // Code block and blockquote
      ['formula'], // Math formulas
      ['clean'], // Clear formatting
    ],
  },
});

// Add a custom handler for image uploads
quill.getModule('toolbar').addHandler('image', () => {
  const input = document.createElement('input');
  input.setAttribute('type', 'file');
  input.setAttribute('accept', 'image/*');
  input.click();

  input.onchange = () => {
    const file = input.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = (e) => {
        const range = quill.getSelection();
        quill.insertEmbed(range.index, 'image', e.target.result);

        // Apply fixed size to images
        const images = document.querySelectorAll('.ql-editor img');
        images.forEach((img) => {
          img.style.width = '300px'; // Fixed width
          img.style.height = 'auto'; // Maintain aspect ratio
        });
      };
      reader.readAsDataURL(file);
    }
  };
});

let currentEditingNote = null;
const defaultCategories = ["Personal", "Academic", "Miscellaneous"];
let selectedCategory = "Personal";

// Random weekly schedules for departments
const departmentSchedules = {
  // predefined schedules
};

// Load department schedule based on code
function loadDepartmentSchedule() {
  const code = document.getElementById('scheduleCode').value.trim();
  const schedule = departmentSchedules[code];

  if (!schedule) {
    alert('Invalid code. Please try again.');
    return;
  }

  renderSchedule(schedule);
}

// Render the schedule in the table
function renderSchedule(schedule) {
  const scheduleBody = document.getElementById('scheduleBody');
  scheduleBody.innerHTML = schedule.map(row => `
    <tr>
      <td>${row.time}</td>
      <td>${row.Mon || ''}</td>
      <td>${row.Tues || ''}</td>
      <td>${row.Wed || ''}</td>
      <td>${row.Thur || ''}</td>
      <td>${row.Fri || ''}</td>
    </tr>
  `).join('');
}

// Save schedule to local storage
function saveScheduleToLocalStorage(code) {
  const schedule = departmentSchedules[code];
  if (!schedule) {
    alert('Invalid code. No schedule to save.');
    return;
  }
  localStorage.setItem('schedule', JSON.stringify(schedule));
  alert('Schedule saved to local storage!');
}

// Load schedule from local storage
function loadSavedSchedule() {
  const savedSchedule = JSON.parse(localStorage.getItem('schedule')) || [];
  renderSchedule(savedSchedule);
}

// Load the calendar
function loadCalendar() {
  const calendar = document.getElementById('calendar');
  const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
  const today = new Date();
  const todayIndex = today.getDay();

  calendar.innerHTML = days.map((day, index) => `
    <div class="day ${index === todayIndex ? 'today' : ''}">${day}</div>
  `).join('');

  document.getElementById('calendarMessage').textContent = 'Make today count!';
}

// Load notes
function loadNotes() {
  const notesList = document.getElementById('notesList');
  const notes = JSON.parse(localStorage.getItem('notes')) || [];
  notesList.innerHTML = notes
    .filter(note => note.category === selectedCategory)
    .map((note, index) => `
      <li>
        <h4>${note.title}</h4>
        <button onclick="showNotePopup(${index})">View</button>
      </li>`).join('');
}

// Save note
function saveNote() {
  const title = prompt("Enter note title:");
  const text = quill.root.innerHTML.trim(); // Quill editor content
  const mediaInput = document.getElementById('noteMedia').files[0];
  const notes = JSON.parse(localStorage.getItem('notes')) || [];
  const reader = new FileReader();

  reader.onload = () => {
    notes.push({ title, text, media: reader.result, category: selectedCategory });
    localStorage.setItem('notes', JSON.stringify(notes));
    loadNotes();
    quill.root.innerHTML = ''; // Clear editor after saving
    document.getElementById('noteMedia').value = '';
  };

  if (mediaInput) {
    reader.readAsDataURL(mediaInput); // Handle media upload
  } else {
    notes.push({ title, text, media: null, category: selectedCategory });
    localStorage.setItem('notes', JSON.stringify(notes));
    loadNotes();
    quill.root.innerHTML = ''; // Clear editor after saving
    document.getElementById('noteMedia').value = '';
  }
}

// Show note popup
function showNotePopup(index) {
  const notes = JSON.parse(localStorage.getItem('notes')) || [];
  const note = notes[index];

  // Display title and content
  document.getElementById('noteTitle').textContent = note.title || "Untitled";
  document.getElementById('noteContent').innerHTML = note.text || "No content available";

  // Handle media preview
  const mediaPreview = document.getElementById('noteMediaPreview');
  if (note.media) {
    mediaPreview.src = note.media;
    mediaPreview.style.display = 'block';
  } else {
    mediaPreview.style.display = 'none';
  }

  currentEditingNote = index; // Track the current note being edited
  document.getElementById('notePopup').style.display = 'flex'; // Show popup
}

// Edit note
function editNote() {
  if (currentEditingNote !== null) {
    const confirmEdit = confirm("Are you sure you want to edit this note?");
    if (confirmEdit) {
      const notes = JSON.parse(localStorage.getItem('notes')) || [];
      const note = notes[currentEditingNote];
      quill.root.innerHTML = note.text;
      notes.splice(currentEditingNote, 1);
      localStorage.setItem('notes', JSON.stringify(notes));
      loadNotes();
      closeNotePopup();
    }
  }
}

// Delete note
function deleteNote() {
  if (currentEditingNote !== null) {
    const confirmDelete = confirm("Are you sure you want to delete this note?");
    if (confirmDelete) {
      const notes = JSON.parse(localStorage.getItem('notes')) || [];
      notes.splice(currentEditingNote, 1);
      localStorage.setItem('notes', JSON.stringify(notes));
      loadNotes();
      closeNotePopup();
    }
  }
}

// Close note popup
function closeNotePopup() {
  document.getElementById('notePopup').style.display = 'none';
}

// Navigate note
function navigateNote(direction) {
  const notes = JSON.parse(localStorage.getItem('notes')) || [];
  if (notes.length === 0) return;

  // Calculate the next note index
  let newIndex = currentEditingNote + direction;

  // Handle wrapping around notes
  if (newIndex < 0) {
    newIndex = notes.length - 1; // Go to last note
  } else if (newIndex >= notes.length) {
    newIndex = 0; // Go to first note
  }

  showNotePopup(newIndex);
}

// Initialize the page
document.addEventListener('DOMContentLoaded', () => {
  loadCalendar();
  loadNotes();
  loadSavedSchedule();
});
  </script>
 </body>
</html>
